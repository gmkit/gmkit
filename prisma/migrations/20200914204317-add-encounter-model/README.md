# Migration `20200914204317-add-encounter-model`

This migration has been generated by Nolan Phillips at 9/14/2020, 5:43:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."sessions" DROP CONSTRAINT "sessions_user_id_fkey"

CREATE TABLE "public"."encounters" (
"id" SERIAL,
"name" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"campaignId" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."EncounterCharacter" (
"id" SERIAL,
"name" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"initiative" integer   NOT NULL ,
"referenceUrl" text   ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."encounters" ADD FOREIGN KEY ("campaignId")REFERENCES "public"."campaigns"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200821151426-add-campaign-table..20200914204317-add-encounter-model
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model User {
   id            Int       @default(autoincrement()) @id
@@ -17,9 +17,8 @@
   updatedAt     DateTime  @default(now()) @map(name: "updated_at")
   campaigns UserInCampaign[]
   @@map(name: "users")
-  Session Session[]
 }
 model Account {
   id                 Int       @default(autoincrement()) @id
@@ -43,9 +42,8 @@
 model Session {
   id           Int      @default(autoincrement()) @id
   userId       Int      @map(name: "user_id")
-  user         User     @relation(fields: [userId], references: [id])
   expires      DateTime
   sessionToken String   @unique @map(name: "session_token")
   accessToken  String   @unique @map(name: "access_token")
   createdAt    DateTime @default(now()) @map(name: "created_at")
@@ -70,9 +68,10 @@
   name      String
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
-  users UserInCampaign[]
+  users      UserInCampaign[]
+  encounters Encounter[]
   @@map(name: "campaigns")
 }
 enum CampaignRole {
@@ -90,4 +89,25 @@
   @@id([userId, campaignId])
   @@map(name: "users_in_campaign")
 }
+
+model Encounter {
+  id         Int      @default(autoincrement()) @id
+  name       String
+  createdAt  DateTime @default(now())
+  updatedAt  DateTime @default(now())
+  campaign   Campaign @relation(fields: [campaignId], references: [id])
+  campaignId Int
+
+  @@map(name: "encounters")
+}
+
+model EncounterCharacter {
+  id        Int      @default(autoincrement()) @id
+  name      String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+
+  initiative   Int
+  referenceUrl String?
+}
```


